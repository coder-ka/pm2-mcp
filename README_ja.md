# PM2 MCP Server

MCPサーバーの学習用に作成されたPM2プロセス管理機能を提供するサーバーです。

## ⚠️ 注意

このプロジェクトはMCPサーバーの学習用に作成されたものです。実用環境での使用には以下の機能が不足しています：

- 本格的なセキュリティ対策
- エラーハンドリングの改善
- パフォーマンス最適化
- 包括的なログ管理
- 設定管理機能
- プロセス監視・アラート機能
- リソース制限・制御

**これは学習用のプロジェクトであり、本番環境では使用しないでください。**

## 概要

PM2を使用したプロセス管理機能をMCPプロトコル経由で提供するサーバーです。プロセスの起動、停止、一覧表示、ログ管理などの基本的な操作が可能です。

## 機能

- **プロセス管理**: PM2を使用したプロセスの起動・停止・一覧表示
- **名前空間分離**: サーバーインスタンス毎に独立した名前空間でプロセス名競合を回避
- **ログ管理**: プロセスの標準出力・標準エラー出力の記録・取得
- **MCP準拠**: 標準的なMCPプロトコルに従った実装

## インストール

```bash
npm install
npm run build
```

## 使用方法

### MCPサーバーとして起動

```bash
npm start
```

### 開発・テスト

```bash
# テスト実行
npm test

# MCP Inspector でデバッグ
npm run inspect

# テスト用プロセス起動
npm run start:test-server
```

## 利用可能なMCPツール

1. **start-process**: 新しいプロセスを起動
   - `script`: 実行するスクリプト・コマンド
   - `args`: 引数の配列 (オプション)
   - `cwd`: 作業ディレクトリ (オプション)

2. **delete-process**: プロセスを停止・削除
   - `name`: 削除するプロセス名

3. **list-processes**: PM2プロセス一覧を表示
   - `namespace`: 名前空間フィルター (オプション)

4. **get-namespace**: 現在のサーバー名前空間を取得

5. **get-process-logs**: 指定プロセスのログを取得
   - `processName`: ログを取得するプロセス名
   - `limit`: 取得する最大ログエントリ数 (デフォルト: 50)
   - `type`: ログタイプ ("stdout" または "stderr")
   - `since`: 指定時刻以降のログ (Unixタイムスタンプ)

6. **get-latest-logs**: 最新ログを取得
   - `processName`: プロセス名
   - `count`: 取得するログエントリ数 (デフォルト: 20)

7. **clear-process-logs**: プロセスのログをクリア
   - `processName`: ログをクリアするプロセス名

## アーキテクチャ

- **MCP SDK**: `@modelcontextprotocol/sdk` を使用したstdio transport
- **プロセス管理**: PM2によるプロセスライフサイクル管理
- **ログ管理**: lowdbを使用したJSONベースのログストレージ
- **ビルドシステム**: ES2022/Node16モジュールでのTypeScriptコンパイル

## ライセンス

MIT